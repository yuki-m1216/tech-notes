# 規制対応とデータ保護

このセクションでは、法規制への対応とデータ保護の考え方について学びます。

## このページで学ぶこと

- コンプライアンスがなぜ重要かを理解する
- 主要な規制（GDPR、個人情報保護法、PCI DSS）の概要を把握する
- データ保護の基本原則を学ぶ
- データレジデンシーとデータ主権の考え方を理解する
- AWS環境でのコンプライアンス対応方法を知る

!!! note "最新情報の確認"
    法規制は改正されることがあります。実務での適用にあたっては、以下の公式リソースで最新情報を確認してください。

    - **GDPR**: [EUR-Lex（EU法令データベース）](https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32016R0679)
    - **個人情報保護法**: [個人情報保護委員会](https://www.ppc.go.jp/)
    - **PCI DSS**: [PCI Security Standards Council](https://www.pcisecuritystandards.org/)

## なぜコンプライアンスが重要か

### コンプライアンスとは

コンプライアンスとは、法令や業界標準、社内規程などのルールを遵守することです。セキュリティ対策とコンプライアンスは密接に関連していますが、同じものではありません。

| 観点 | セキュリティ | コンプライアンス |
|------|------------|----------------|
| 目的 | システムと情報の保護 | ルールへの適合証明 |
| 基準 | リスクベース | 規制要件ベース |
| 評価 | 継続的な改善 | 監査による適合確認 |

!!! info "セキュリティとコンプライアンスの関係"
    セキュリティ対策が十分でもコンプライアンス違反になることがあり、逆にコンプライアンスを満たしていてもセキュリティが不十分なこともあります。両方の視点が必要です。

### コンプライアンスが重要な理由

**法的義務と罰則**

規制違反には厳しい罰則が設けられています。

| 規制 | 最大罰則 | 根拠 |
|------|---------|------|
| GDPR | 全世界年間売上高の4%または2,000万ユーロのいずれか高い方 | [Article 83](https://gdpr-info.eu/art-83-gdpr/) |
| 個人情報保護法（日本） | 1億円以下の罰金（法人） | [2022年改正法](https://www.businesslawyers.jp/practices/1427) |
| PCI DSS | カード会社からの取引停止、罰金 | [PCI DSSコンプライアンス](https://www.kiteworks.com/ja/risk-compliance-glossary/pci-dss/) |

**ビジネスへの影響**

- **顧客との信頼関係**: データ保護は顧客からの信頼の基盤
- **取引機会**: 多くの企業がサプライヤーにコンプライアンス証明を要求
- **レピュテーション**: 違反の公表による企業イメージの低下

## 主要な規制の理解

### GDPR（EU一般データ保護規則）

GDPRは、EU域内の個人データ保護を目的とした規制です。EU域外の企業であっても、EU居住者のデータを扱う場合は対象となります。

**主な要件**

| 要件 | 内容 |
|------|------|
| 適法性の根拠 | データ処理には同意または正当な根拠が必要 |
| データ主体の権利 | アクセス権、訂正権、削除権（忘れられる権利）、データポータビリティ |
| データ保護責任者 | 一定規模以上の組織はDPO（Data Protection Officer）の設置が必要 |
| 侵害通知 | 72時間以内に監督機関への通知義務 |
| 越境移転 | EU域外へのデータ移転には適切な保護措置が必要 |

**適用範囲の判断**

```
EU居住者のデータを扱う？
├─ Yes → GDPRの対象となる可能性が高い
│   └─ EU向けにサービスを提供している？
│       ├─ Yes → 確実に対象
│       └─ No → 個別判断が必要
└─ No → GDPRの対象外
```

### 日本の個人情報保護法

日本国内で個人情報を取り扱う事業者に適用される法律です。2022年の改正で罰則強化や越境移転規制の厳格化が行われました。

**主な要件**

| 要件 | 内容 |
|------|------|
| 利用目的の特定・通知 | 取得時に利用目的を明示 |
| 安全管理措置 | 組織的・人的・物理的・技術的安全管理措置の実施 |
| 第三者提供の制限 | 原則として本人同意が必要 |
| 漏えい等報告 | 一定の漏えい等は個人情報保護委員会への報告と本人通知が必要 |
| 越境移転 | 外国への提供には本人同意または基準適合体制が必要 |

**個人情報の定義**

個人情報とは、生存する個人に関する情報で、以下のいずれかに該当するものです：

- 氏名、生年月日等により特定の個人を識別できるもの
- 個人識別符号（マイナンバー、運転免許証番号等）が含まれるもの

### PCI DSS（Payment Card Industry Data Security Standard）

クレジットカード情報を取り扱う事業者に適用される業界標準です。

**12の要件（概要）**

| カテゴリ | 要件 |
|---------|------|
| ネットワークセキュリティ | ファイアウォール設置、デフォルトパスワード変更 |
| カード会員データ保護 | 保存データの保護、送信データの暗号化 |
| 脆弱性管理 | ウイルス対策、セキュアな開発 |
| アクセス制御 | 業務上必要な範囲に制限、一意のID付与、物理アクセス制限 |
| 監視とテスト | ネットワーク監視、定期的なテスト |
| ポリシー維持 | 情報セキュリティポリシーの維持 |

**準拠レベル**

カード取引量に応じて準拠レベルが異なります（以下はVisaの基準例。カードブランドにより異なる場合があります）。

| レベル | 年間取引量 | 要件 |
|--------|-----------|------|
| レベル1 | 600万件以上 | QSA（認定審査機関）による年次監査 |
| レベル2 | 100万〜600万件 | 自己問診（SAQ）+ 四半期スキャン |
| レベル3 | 2万〜100万件 | 自己問診（SAQ）+ 四半期スキャン |
| レベル4 | 2万件未満 | 自己問診（SAQ）推奨 |

!!! tip "PCI DSSの範囲縮小"
    カード情報を自社で保持せず、決済代行サービス（Stripe等）を利用することで、PCI DSSの準拠範囲を大幅に縮小できます。これは「非保持化」と呼ばれ、トークナイゼーション技術により実現されます。詳細は[日本カード情報セキュリティ協議会](https://www.jcdsc.org/topics/vol02.php)や[Stripe のトークン化解説](https://stripe.com/resources/more/payment-tokenization-101)を参照してください。

## データ保護の原則

### データの分類

すべてのデータを同じレベルで保護することは非効率です。データを分類し、重要度に応じた保護を行います。

**分類の例**

| 分類 | 内容例 | 保護レベル |
|------|--------|-----------|
| 機密 | 個人情報、カード情報、認証情報 | 暗号化必須、アクセス厳格制限 |
| 社外秘 | 財務データ、契約情報、内部文書 | アクセス制限、監査ログ |
| 内部 | 業務マニュアル、社内連絡 | 基本的なアクセス制御 |
| 公開 | 製品情報、プレスリリース | 改ざん防止のみ |

### データ最小化の原則

必要以上のデータを収集・保持しないという原則です。

**実践ポイント**

- 収集するデータは目的達成に必要な最小限に
- 不要になったデータは適時削除
- ログに含める情報も必要最小限に

```python
# 悪い例：必要以上の情報をログに記録
logger.info(f"User login: {user.email}, password: {user.password}, credit_card: {user.card_number}")

# 良い例：必要な情報のみ記録
logger.info(f"User login: user_id={user.id}")
```

### 目的外利用の禁止

収集時に明示した目的以外でデータを使用してはいけません。

**よくある違反パターン**

- マーケティング目的で収集したメールアドレスを第三者に販売
- サポート目的で取得した情報を営業活動に利用
- 分析目的で収集したデータを個人特定可能な形で外部共有

### 保持期間と削除

データは必要な期間のみ保持し、不要になったら削除します。

**保持期間の決定要因**

| 要因 | 例 |
|------|-----|
| 法的要件 | 税務関連書類は7年以上保存（欠損金がある場合は10年） |
| 契約要件 | 契約終了後○年間保持 |
| 業務要件 | 分析に必要な期間 |

!!! warning "削除の実装"
    データ削除は論理削除（フラグを立てる）ではなく、物理削除が求められることがあります。バックアップからの復元も考慮した削除戦略が必要です。

## データレジデンシーとデータ主権

### なぜデータの保存場所が重要か

データの物理的な保存場所によって、適用される法律や規制が変わります。

**データレジデンシー**: データが物理的に保存される地理的な場所

**データ主権**: データに対してどの国の法律が適用されるか

### リージョン選択の考慮点

AWSでリージョンを選択する際、以下を考慮します。

| 考慮点 | 内容 |
|--------|------|
| 法的要件 | 特定の国にデータを保存する義務があるか |
| レイテンシー | ユーザーに近いリージョンか |
| サービス可用性 | 必要なAWSサービスが利用可能か |
| コスト | リージョンによって価格が異なる |

### 越境データ転送の制約

多くの規制では、国境を越えたデータ転送に制限を設けています。

**GDPRの場合**

EU域外へのデータ転送には、以下のいずれかが必要です：

- 十分性認定を受けた国への転送（日本とEUは相互に認定済み）
- 標準契約条項（SCC）の締結
- 拘束的企業準則（BCR）の承認

**日本の個人情報保護法の場合**

外国への個人データ提供には、以下のいずれかが必要です：

- 本人の同意
- 基準適合体制を整備した事業者への提供
- 日本と同等の保護水準を有する国への提供

### AWSでのデータレジデンシー対応

**リージョン制限の実装（SCP）**

AWS Organizationsのサービスコントロールポリシー（SCP）を使用して、組織全体でリージョンを制限できます。

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Deny",
      "Action": "*",
      "Resource": "*",
      "Condition": {
        "StringNotEquals": {
          "aws:RequestedRegion": ["ap-northeast-1", "ap-northeast-3"]
        }
      }
    }
  ]
}
```

!!! warning "グローバルサービスの考慮"
    上記のSCPはIAM、CloudFront、Route 53等のグローバルサービスもブロックする可能性があります。実運用では、グローバルサービスを除外する条件（`NotAction` や特定サービスの除外）を追加する必要があります。詳細は[AWS公式ドキュメント](https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_examples_general.html#example-scp-deny-region)を参照してください。

**AWS Control Towerのリージョン拒否**

AWS Control Towerを使用すると、組織全体で許可するリージョンを制御できます。

## AWS環境でのコンプライアンス対応

### 責任共有モデルとコンプライアンス

AWSの責任共有モデルはコンプライアンスにも適用されます。

```
┌─────────────────────────────────────────────────────────┐
│              お客様の責任（クラウド内のセキュリティ）          │
│  ・データの分類と保護                                      │
│  ・アクセス制御の設定                                      │
│  ・アプリケーションレベルのコンプライアンス                   │
│  ・監査ログの管理                                         │
├─────────────────────────────────────────────────────────┤
│                 AWSの責任（クラウドのセキュリティ）          │
│  ・物理インフラのセキュリティ                               │
│  ・ハイパーバイザーの管理                                  │
│  ・AWS サービスのコンプライアンス認証取得                    │
└─────────────────────────────────────────────────────────┘
```

### AWS Artifact

AWS Artifactは、AWSのコンプライアンスレポートや契約書にアクセスするためのサービスです。

**利用可能なドキュメント**

| 種類 | 内容 |
|------|------|
| SOC レポート | AWSの統制に関する第三者監査レポート |
| PCI DSS | PCI DSS準拠の証明 |
| ISO 認証 | ISO 27001等の認証書 |
| 契約書 | BAA（HIPAA）、DPA（GDPR）等 |

**活用方法**

```
監査対応での活用例：
1. 監査人から「AWSのセキュリティ統制の証拠」を求められる
2. AWS ArtifactからSOC 2レポートをダウンロード
3. 監査人に提出し、AWSインフラ部分の統制を説明
```

### AWS Configによる継続的コンプライアンス

AWS Configを使用して、リソースが規制要件に準拠しているかを継続的にチェックできます。

**コンフォーマンスパック**

AWSが提供する事前定義されたルールセットです。

| パック名 | 対象規制 |
|---------|---------|
| Operational Best Practices for PCI DSS | PCI DSS |
| Operational Best Practices for NIST CSF | NIST CSF |
| Operational Best Practices for CIS | CIS Benchmark |

**カスタムルールの例**

```yaml
# S3バケットの暗号化チェック
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  S3BucketEncryptionRule:
    Type: AWS::Config::ConfigRule
    Properties:
      ConfigRuleName: s3-bucket-server-side-encryption-enabled
      Source:
        Owner: AWS
        SourceIdentifier: S3_BUCKET_SERVER_SIDE_ENCRYPTION_ENABLED
```

### Security Hubによる統合管理

AWS Security Hubは、複数のセキュリティサービスの検出結果を統合し、コンプライアンス状況を可視化します。

**セキュリティ標準**

| 標準 | 内容 |
|------|------|
| AWS 基礎セキュリティのベストプラクティス | AWS推奨のセキュリティ設定 |
| CIS AWS Foundations Benchmark | CISによるベストプラクティス |
| PCI DSS | PCI DSS関連のチェック |

### 監査ログの管理

コンプライアンスには、適切な監査ログの保持が不可欠です。

**CloudTrailの設定**

| 設定項目 | 推奨値 | 理由 |
|---------|--------|------|
| マルチリージョン | 有効 | すべてのリージョンの操作を記録 |
| ログファイル検証 | 有効 | ログの改ざん検知 |
| S3バケット暗号化 | 有効 | ログデータの保護 |
| ログ保持期間 | 規制要件に応じて | 多くの規制で1年以上を要求 |

**ログの改ざん防止**

```
CloudTrail → S3バケット
              ├─ バケットポリシーで削除禁止
              ├─ オブジェクトロック（WORM）
              └─ 別アカウントへのレプリケーション
```

## よくある失敗パターン

### チェックリスト対応の罠

**問題**: 規制のチェックリストを形式的に満たすことだけに集中し、実質的なセキュリティが疎かになる。

**対策**:

- チェックリストは最低限の基準と捉える
- リスクベースで追加対策を検討
- 「なぜこの要件があるのか」を理解する

### 一度きりのコンプライアンス

**問題**: 監査時だけ対応し、日常的にはコンプライアンスを意識しない。

**対策**:

- AWS Configで継続的なチェックを自動化
- 定期的なレビューをプロセスに組み込む
- コンプライアンス状況のダッシュボード化

### 文書と実態の乖離

**問題**: ポリシー文書は立派だが、実際の運用が伴っていない。

**対策**:

- ポリシーは実行可能な内容に
- 定期的な内部監査で乖離を検出
- 自動化でポリシーを強制

### 責任範囲の誤解

**問題**: 「AWSを使っているからコンプライアンスは大丈夫」と誤解する。

**対策**:

- 責任共有モデルを正しく理解
- お客様責任の範囲を明確化
- AWSの認証はインフラ部分のみであることを認識

## 実践的なアプローチ

### コンプライアンス対応の進め方

```
1. 要件の特定
   └─ 適用される規制を洗い出す

2. ギャップ分析
   └─ 現状と要件の差分を特定

3. 対策の優先順位付け
   └─ リスクと影響度で優先順位決定

4. 実装
   └─ 技術的・組織的対策の実施

5. 継続的モニタリング
   └─ AWS Config、Security Hubで監視

6. 定期レビュー
   └─ 規制の変更、新たなリスクへの対応
```

### 小規模チームでの対応

すべての規制に完全対応することは、リソースの限られた小規模チームには困難です。

**優先順位の考え方**

1. **法的義務**: 違反すると罰則があるもの（個人情報保護法等）
2. **契約義務**: 顧客との契約で求められるもの
3. **業界標準**: 準拠が期待されるもの（ISO 27001等）

**効率化のポイント**

- マネージドサービスの活用（責任範囲の縮小）
- 自動化ツールの活用（AWS Config、Security Hub）
- 外部専門家の活用（監査時のみ等）

## まとめ

| 項目 | ポイント |
|------|---------|
| コンプライアンスの重要性 | 法的義務、ビジネス機会、信頼の維持 |
| 主要規制 | GDPR、個人情報保護法、PCI DSS等 |
| データ保護原則 | 分類、最小化、目的制限、保持期間管理 |
| データレジデンシー | 保存場所と適用法の関係を理解 |
| AWS活用 | Artifact、Config、Security Hubで効率化 |
| 継続性 | 一度きりでなく継続的な取り組みが必要 |

コンプライアンスは「やらなければならないこと」ですが、適切に取り組めば組織のセキュリティ向上にもつながります。形式的な対応ではなく、本質を理解した上で効率的に取り組みましょう。

[セキュリティの基本原則に戻る ←](basic-principles.md){ .md-button }
